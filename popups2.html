<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>뷰어 팝업 — 문서분류 · 알림 · 스탬프편집</title>

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

<!-- Tabulator CSS + JS -->
<link  href="https://unpkg.com/tabulator-tables@6.1.0/dist/css/tabulator.min.css" rel="stylesheet">
<script src="https://unpkg.com/tabulator-tables@6.1.0/dist/js/tabulator.min.js"></script>

<style>
/* ═══════════════════════════════════════════
   DESIGN TOKENS
   ═══════════════════════════════════════════ */
:root {
  --orange:        #E8712A;
  --orange-hover:  #d4611f;
  --beige-bg:      #FDF3EC;
  --beige-border:  #F0DDD0;
  --row-alt:       #FDF3EC;
  --header-bg:     #F5F5F5;
  --border:        #E0E0E0;
  --text-dark:     #2C2C2C;
  --text-mid:      #555;
  --text-light:    #999;
  --white:         #FFFFFF;
  --gray-btn:      #5C5C5C;
  --gray-btn-hover:#4a4a4a;
  --font: 'Malgun Gothic','Apple SD Gothic Neo','Noto Sans KR',sans-serif;
}

/* ═══════════════════════════════════════════
   RESET & BASE
   ═══════════════════════════════════════════ */
*,*::before,*::after{ box-sizing:border-box; margin:0; padding:0; }
body {
  font-family: var(--font);
  font-size: 13px;
  color: var(--text-dark);
  background: #eee;
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 50px 20px 40px;
}

/* ═══════════════════════════════════════════
   LAUNCHER
   ═══════════════════════════════════════════ */
.launcher {
  position: fixed; top:0; left:0; right:0;
  background: #1a1a2e;
  padding: 10px 18px;
  display: flex; gap:8px; flex-wrap:wrap; align-items:center;
  z-index: 9999;
  box-shadow: 0 2px 8px rgba(0,0,0,.3);
}
.launcher .lbl { color:#aaa; font-size:12px; margin-right:6px; font-weight:600; letter-spacing:.5px; }
.launcher button {
  background:#16213e; color:#e0e0e0;
  border:1px solid #0f3460; border-radius:4px;
  padding:5px 14px; font-size:11.5px;
  cursor:pointer; font-family:var(--font);
  transition:background .15s,border-color .15s;
}
.launcher button:hover { background:#0f3460; border-color:#e94560; color:#fff; }

/* ═══════════════════════════════════════════
   OVERLAY
   ═══════════════════════════════════════════ */
.modal-overlay {
  display:none;
  position:fixed; inset:0;
  background:rgba(0,0,0,.40);
  z-index:1000;
  align-items:center; justify-content:center;
}
.modal-overlay.active { display:flex; }

/* ═══════════════════════════════════════════
   MODAL SHELL
   ═══════════════════════════════════════════ */
.modal {
  background:var(--white);
  border-radius:8px;
  box-shadow:0 8px 36px rgba(0,0,0,.20);
  padding:28px 30px 24px;
  max-height:85vh;
  overflow-y:auto;
  animation:slideUp .22s cubic-bezier(.34,1.56,.64,1);
}
@keyframes slideUp {
  from { opacity:0; transform:translateY(16px); }
  to   { opacity:1; transform:translateY(0); }
}
.modal--sm  { width:380px; }
.modal--md  { width:560px; }
.modal--lg  { width:680px; }

/* ═══════════════════════════════════════════
   SECTION TITLE
   ═══════════════════════════════════════════ */
.section-title {
  display:flex; align-items:center; gap:8px;
  margin-bottom:14px;
}
.section-title .dot {
  width:8px; height:8px;
  border-radius:50%;
  background:var(--orange);
  flex-shrink:0;
}
.section-title span { font-size:15px; font-weight:700; }

/* ═══════════════════════════════════════════
   NOTICE BAR
   ═══════════════════════════════════════════ */
.notice-bar {
  background:var(--beige-bg);
  border:1px solid var(--beige-border);
  border-radius:5px;
  padding:11px 16px;
  font-size:13px;
  font-weight:600;
  color:var(--orange);
  margin-bottom:14px;
}

/* ═══════════════════════════════════════════
   INPUT
   ═══════════════════════════════════════════ */
.inp {
  border:1px solid var(--border);
  border-radius:4px;
  padding:8px 12px;
  font-size:13px;
  font-family:var(--font);
  color:var(--text-dark);
  background:var(--white);
  outline:none;
  transition:border-color .15s;
  width:100%;
}
.inp:focus { border-color:var(--orange); }
.inp::placeholder { color:var(--text-light); }

/* ═══════════════════════════════════════════
   SEARCH ROW
   ═══════════════════════════════════════════ */
.search-row {
  display:flex; align-items:center; gap:10px;
  margin-bottom:14px;
}
.search-row .inp { flex:1; }

/* ═══════════════════════════════════════════
   BUTTONS
   ═══════════════════════════════════════════ */
.btn-orange {
  background:var(--orange); color:var(--white);
  border:none; border-radius:4px;
  padding:8px 22px; font-size:13px; font-weight:600;
  font-family:var(--font); cursor:pointer;
  transition:background .15s; white-space:nowrap;
  flex-shrink:0;
}
.btn-orange:hover { background:var(--orange-hover); }

.btn-gray {
  background:var(--gray-btn); color:var(--white);
  border:none; border-radius:4px;
  padding:9px 22px; font-size:13px; font-weight:500;
  font-family:var(--font); cursor:pointer;
  transition:background .15s;
}
.btn-gray:hover { background:var(--gray-btn-hover); }

.btn-row { display:flex; justify-content:center; gap:8px; margin-top:20px; }
.btn-row.right { justify-content:flex-end; }

/* ═══════════════════════════════════════════
   TAB
   ═══════════════════════════════════════════ */
.tab-wrap {
  display:flex;
  border-bottom:2px solid var(--border);
  margin-bottom:0;
}
.tab-btn {
  padding:8px 20px;
  font-size:13px; font-weight:600;
  font-family:var(--font);
  border:none; background:var(--white);
  color:var(--text-mid); cursor:pointer;
  border-radius:5px 5px 0 0;
  margin-bottom:-2px;
  transition:background .15s, color .15s;
}
.tab-btn.active { background:var(--orange); color:var(--white); }
.tab-btn:not(.active):hover { background:#f5f5f5; }

/* ═══════════════════════════════════════════
   STAMP INPUT
   ═══════════════════════════════════════════ */
.stamp-input-area { padding-top:20px; }
.stamp-input-area .inp {
  border-radius:6px;
  padding:13px 16px;
  font-size:13px;
}

/* ═══════════════════════════════════════════
   ALERT
   ═══════════════════════════════════════════ */
.alert-wrap { text-align:center; padding:40px 30px 36px; }
.alert-icon { font-size:38px; margin-bottom:22px; }
.alert-title { font-size:18px; font-weight:700; color:var(--orange); margin-bottom:18px; line-height:1.4; }
.alert-body { font-size:14px; color:var(--text-mid); line-height:1.8; margin-bottom:28px; }
.alert-wrap .btn-gray { padding:10px 36px; font-size:14px; }

/* ═══════════════════════════════════════════
   ▲▼ 정렬 버튼
   ═══════════════════════════════════════════ */
.order-btns { display:flex; gap:4px; justify-content:center; }
.order-btn {
  width:30px; height:28px;
  border:1px solid var(--border);
  border-radius:3px;
  background:var(--white);
  cursor:pointer;
  display:flex; align-items:center; justify-content:center;
  font-size:11px; color:var(--text-mid);
  transition:background .12s, border-color .12s;
  font-family:var(--font);
}
.order-btn:hover { background:#f0f0f0; border-color:#ccc; }


/* ═══════════════════════════════════════════
   TABULATOR 오버라이드
   ═══════════════════════════════════════════ */

/* 최상위 컨테이너 */
.tabulator {
  border: 1px solid var(--border) !important;
  border-radius: 0 4px 4px 4px !important;
  font-family: var(--font) !important;
  font-size: 13px !important;
  color: var(--text-dark) !important;
  box-shadow: none !important;
}

/* ── 헤더 ── */
.tabulator .tabulator-header {
  background: var(--header-bg) !important;
  border-bottom: 1px solid var(--border) !important;
  height: auto !important;
}
.tabulator .tabulator-header .tabulator-col {
  border-right: 1px solid var(--border) !important;
  background: var(--header-bg) !important;
  height: auto !important;
}
.tabulator .tabulator-header .tabulator-col:last-child {
  border-right: none !important;
}
/* 정렬 아이콘 숨김 */
.tabulator .tabulator-header .tabulator-col .tabulator-col-sorter { display:none !important; }
/* 헤더 텍스트 스타일 */
.tabulator .tabulator-header .tabulator-col .tabulator-col-header-content {
  padding: 9px 8px !important;
  text-align: center !important;
  font-weight: 600 !important;
  color: var(--text-mid) !important;
  white-space: nowrap;
}

/* ── 행 ── */
.tabulator .tabulator-row {
  border-bottom: 1px solid var(--border) !important;
  background: var(--white) !important;
  height: auto !important;
  min-height: 0 !important;
}
/* 짝수 행 베이지 */
.tabulator .tabulator-row:nth-child(even) {
  background: var(--row-alt) !important;
}
/* 호버 */
.tabulator .tabulator-row:hover {
  background: #FFF8F0 !important;
  cursor: pointer;
}
/* 선택 행 */
.tabulator .tabulator-row.tabulator-selected {
  background: #FFF0E0 !important;
  color: var(--text-dark) !important;
}
.tabulator .tabulator-row.tabulator-selected:hover {
  background: #FFE8D6 !important;
}

/* ── 셀 ── */
.tabulator .tabulator-row .tabulator-cell {
  border-right: 1px solid var(--border) !important;
  padding: 10px 8px !important;
  vertical-align: middle !important;
  height: auto !important;
}
.tabulator .tabulator-row .tabulator-cell:last-child {
  border-right: none !important;
}

/* ── 빈 행 메시지 숨김 ── */
.tabulator .tabulator-placeholder { display:none !important; }

/* ── 스크롤바 ── */
.tabulator .tabulator-tableWrap::-webkit-scrollbar        { width:6px; height:6px; }
.tabulator .tabulator-tableWrap::-webkit-scrollbar-track   { background:#f1f1f1; }
.tabulator .tabulator-tableWrap::-webkit-scrollbar-thumb   { background:#ccc; border-radius:3px; }

/* ═══════════════════════════════════════════
   반응형
   ═══════════════════════════════════════════ */
@media(max-width:600px){
  .modal--sm,.modal--md,.modal--lg { width:95vw !important; }
}
</style>
</head>
<body>

<!-- LAUNCHER -->
<div class="launcher">
  <span class="lbl">▶ 뷰어 팝업</span>
  <button onclick="openModal('modal-문서분류')">① 문서 분류</button>
  <button onclick="openModal('modal-알림')">② 알림 (경고)</button>
  <button onclick="openModal('modal-스탬프편집')">③ 스탬프 편집</button>
  <button onclick="openAll()">⬚ 모두 열기</button>
</div>


<!-- ① 문서 분류 -->
<div class="modal-overlay" id="modal-문서분류">
  <div class="modal modal--md">
    <div class="section-title"><span class="dot"></span><span>문서 분류</span></div>
    <div class="notice-bar">분류할 문서를 선택해주세요.</div>
    <div class="search-row">
      <input type="text" class="inp" placeholder="" />
      <button class="btn-orange">조회</button>
    </div>
    <div class="tab-wrap">
      <button class="tab-btn active" data-tab="문서목록">문서목록</button>
      <button class="tab-btn"        data-tab="즐겨찾기">즐겨찾기</button>
    </div>
    <div id="doc-tabulator"></div>
    <div class="btn-row right" style="margin-top:22px;">
      <button class="btn-orange" id="btn-변경하기">변경하기</button>
      <button class="btn-gray"   id="btn-즐겨찾기등록">즐겨찾기 등록</button>
      <button class="btn-gray"   onclick="closeModal('modal-문서분류')">닫기</button>
    </div>
  </div>
</div>


<!-- ② 알림 (경고) -->
<div class="modal-overlay" id="modal-알림">
  <div class="modal modal--sm" style="padding:0; border-radius:8px; overflow:hidden;">
    <div class="alert-wrap">
      <div class="alert-icon">⚠️</div>
      <div class="alert-title">요청하신 업무가 정상적으로 처리되지 않았습니다.</div>
      <div class="alert-body">요청 정보를 확인해주시거나<br>잠시 후 다시 이용해주시기 바랍니다.</div>
      <button class="btn-gray" onclick="closeModal('modal-알림')">닫기</button>
    </div>
  </div>
</div>


<!-- ③ 스탬프 편집 -->
<div class="modal-overlay" id="modal-스탬프편집">
  <div class="modal modal--lg">
    <div class="section-title" style="margin-bottom:10px;"><span class="dot"></span><span>스탬프 편집</span></div>
    <hr style="border:none; border-top:2px solid var(--orange); margin-bottom:14px;">
    <div id="stamp-tabulator"></div>
    <div class="stamp-input-area">
      <input type="text" class="inp" id="stamp-inp" placeholder="스탬프 문장을 입력해주세요." />
    </div>
    <div class="btn-row right" style="margin-top:22px;">
      <button class="btn-orange" id="btn-저장">저장</button>
      <button class="btn-gray"   id="btn-수정">수정</button>
      <button class="btn-gray"   id="btn-삭제">삭제</button>
      <button class="btn-gray"   onclick="closeModal('modal-스탬프편집')">닫기</button>
    </div>
  </div>
</div>


<!-- ═══ JS ═══ -->
<script>
$(function(){

  /* ── 모달 열기·닫기 ── */
  window.openModal  = function(id){ $('#'+id).addClass('active'); };
  window.closeModal = function(id){ $('#'+id).removeClass('active'); };
  window.openAll    = function(){ $('.modal-overlay').addClass('active'); };

  $('.modal-overlay').on('click', function(e){
    if($(e.target).is('.modal-overlay')) $(this).removeClass('active');
  });

  /* ── 탭 전환 ── */
  $('.tab-btn').on('click', function(){
    $('.tab-btn').removeClass('active');
    $(this).addClass('active');
  });


  /* ════════════════════════════════════════════
       ① 문서 분류 Tabulator
       ════════════════════════════════════════════ */
  var docData = [];
  for(var i = 0; i < 11; i++){
    docData.push({ no: i+1, name: '보험차익 과세 확인서' });
  }

  var docTable = $("#doc-tabulator").tabulator({
    layout: "fitColumns",
    height: 340,
    selectable: 1,
    data: docData,
    columns: [
      {
        title: "No",
        field: "no",
        width: 50,
        headerSort: false,
        formatter: function(cell){
          return '<span style="display:block;text-align:center;color:var(--text-mid);">'+cell.getValue()+'</span>';
        }
      },
      {
        title: "문서명",
        field: "name",
        headerSort: false,
        formatter: function(cell){
          return '<span style="display:block;padding-left:16px;">'+cell.getValue()+'</span>';
        }
      }
    ]
  });


  /* ════════════════════════════════════════════
       ③ 스탬프 편집 Tabulator
       ════════════════════════════════════════════ */
  var stampData = [
    { no:1, date:"2025.11.24\n10:04:35", text:"스탬프 문구"    },
    { no:2, date:"2025.11.24\n10:04:35", text:"두번째 스탬프" }
  ];

  var stampTable = $("#stamp-tabulator").tabulator({
    layout: "fitColumns",
    height: false,
    selectable: 1,
    data: stampData,
    columns: [
      {
        title: "No",
        field: "no",
        width: 50,
        headerSort: false,
        formatter: function(cell){
          return '<span style="display:block;text-align:center;color:var(--text-mid);">'+cell.getValue()+'</span>';
        }
      },
      {
        title: "등록일자",
        field: "date",
        width: 120,
        headerSort: false,
        formatter: function(cell){
          return '<span style="display:block;text-align:center;color:var(--text-mid);font-size:12.5px;line-height:1.5;white-space:pre-line;">'+cell.getValue()+'</span>';
        }
      },
      {
        title: "스탬프 문장",
        field: "text",
        headerSort: false,
        headerHalign: "left",
        formatter: function(cell){
          return '<span style="display:block;padding-left:20px;">'+cell.getValue()+'</span>';
        }
      },
      {
        title: "정렬순서",
        field: "order",
        width: 100,
        headerSort: false,
        formatter: function(cell){
          var pos = cell.getRow().getPosition() - 1; /* 0-based 행 인덱스 */
          return '<div class="order-btns">'
               + '<button class="order-btn" data-dir="-1" data-row="'+pos+'">▲</button>'
               + '<button class="order-btn" data-dir="1"  data-row="'+pos+'">▼</button>'
               + '</div>';
        }
      }
    ]
  });

  /* ── ▲▼ 클릭 이벤트 위임 ── */
  $('#stamp-tabulator').on('click', '.order-btn', function(e){
    e.stopPropagation();

    var dir    = parseInt($(this).data('dir'));
    var idx    = parseInt($(this).data('row'));
    var target = idx + dir;
    var data   = stampTable.getData();

    if(target < 0 || target >= data.length) return;

    /* swap */
    var tmp      = data[idx];
    data[idx]    = data[target];
    data[target] = tmp;

    /* No 재배정 */
    data.forEach(function(d,i){ d.no = i + 1; });

    /* 갱신 전 현재 선택 행 기억 */
    var selBefore = stampTable.getSelectedRows();
    var wasSelected = -1;
    if(selBefore.length > 0) wasSelected = selBefore[0].getPosition() - 1;

    stampTable.setData(data);

    /* 이동된 행 재선택 */
    if(wasSelected === idx)      stampTable.selectRow(target);
    else if(wasSelected === target) stampTable.selectRow(idx);
    else if(wasSelected >= 0)    stampTable.selectRow(wasSelected);
  });

  /* ── 행 선택·해제 시 입력란 동기 ── */
  stampTable.on("rowSelection", function(row){
    $('#stamp-inp').val(row.getData().text);
  });
  stampTable.on("rowDeselected", function(){
    $('#stamp-inp').val('');
  });

  /* ── 저장 ── */
  $('#btn-저장').on('click', function(){
    var val = $('#stamp-inp').val().trim();
    if(!val) return;
    var now = new Date();
    var pad = function(n){ return n<10?'0'+n:n; };
    var d = now.getFullYear()+'.'+pad(now.getMonth()+1)+'.'+pad(now.getDate())
          +'\n'+pad(now.getHours())+':'+pad(now.getMinutes())+':'+pad(now.getSeconds());
    var data = stampTable.getData();
    data.push({ no: data.length+1, date: d, text: val });
    stampTable.setData(data);
    stampTable.deselectRow();
    $('#stamp-inp').val('');
  });

  /* ── 수정 ── */
  $('#btn-수정').on('click', function(){
    var sel = stampTable.getSelectedRows();
    if(sel.length === 0) return;
    var val = $('#stamp-inp').val().trim();
    if(!val) return;
    sel[0].update({ text: val });
  });

  /* ── 삭제 ── */
  $('#btn-삭제').on('click', function(){
    var sel = stampTable.getSelectedRows();
    if(sel.length === 0) return;
    stampTable.deleteRow(sel[0].getIndex());
    /* No 재배정 */
    var data = stampTable.getData();
    data.forEach(function(d,i){ d.no = i+1; });
    stampTable.setData(data);
    $('#stamp-inp').val('');
  });

});
</script>
</body>
</html>
