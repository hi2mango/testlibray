<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tabulator 전체선택 체크박스 (기본 + CSS 커스텀)</title>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tabulator-tables@6.3.0/dist/css/tabulator.min.css">
  <script src="https://cdn.jsdelivr.net/npm/tabulator-tables@6.3.0/dist/js/tabulator.min.js"></script>

  <style>
    :root{
      --line: #d8dbe3;
      --subLine: #eceff6;
      --headBg: #f3f5f9;
      --stripe: #f7f8fb;
      --selected: #f4e2d9;
      --accent: #ff8a00;
      --topbar: #2b73ff;
      --chkBorder: #cfd6e4;
      --text: #1f2430;
    }

    body{
      margin:24px;
      font-family: system-ui, -apple-system, "Noto Sans KR", sans-serif;
      background:#fff;
      color:var(--text);
    }

    .grid-wrap{
      width: 820px;
      border:1px solid var(--line);
      border-top:3px solid var(--topbar);
      background:#fff;
      overflow:hidden;
    }

    /* Tabulator 바깥 테두리 제거 (wrap에서 관리) */
    .tabulator{
      border:none;
      background:transparent;
    }

    /* 헤더 스타일 */
    .tabulator .tabulator-header{
      background:var(--headBg);
      border-bottom:1px solid var(--line);
    }

    /* 헤더/셀 세로정렬 안정화 */
    .tabulator .tabulator-col,
    .tabulator .tabulator-cell{
      display:flex;
      align-items:center;
      box-sizing:border-box;
    }

    /* 셀 기본 라인 */
    .tabulator .tabulator-cell{
      border-right:1px solid var(--subLine);
      background:transparent;
    }
    .tabulator .tabulator-row .tabulator-cell:last-child{
      border-right:none;
    }

    /* 행 높이: 고정 height 대신 min-height로 틀어짐 방지 */
    .tabulator .tabulator-row{
      min-height:48px;
      border-bottom:1px solid var(--subLine);
      background:#fff;
    }

    /* 줄무늬 */
    .tabulator .tabulator-row:nth-child(even){
      background:var(--stripe);
    }

    /* 선택 배경 */
    .tabulator .tabulator-row.tabulator-selected{
      background:var(--selected) !important;
    }

    /* 텍스트 컬럼 padding/ellipsis */
    .tabulator .tabulator-cell{
      padding: 0 14px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-size:16px;
    }

    /* No / 구분 가운데 정렬 */
    .tabulator .tabulator-cell[tabulator-field="no"],
    .tabulator .tabulator-cell[tabulator-field="type"]{
      justify-content:center;
      font-weight:600;
    }

    /* 체크박스 컬럼(rowSelection) 가운데 정렬 (헤더 + 바디) */
    .tabulator .tabulator-col[tabulator-field="_rowSelect"],
    .tabulator .tabulator-cell[tabulator-field="_rowSelect"]{
      justify-content:center;
      padding:0;                 /* 체크박스 컬럼은 padding 제거 */
    }

    /* ================================
       체크박스 커스텀 (rowSelection)
       - 틀(프레임)은 항상 보임
       - ROW는 체크하면 ✔ 표시
       - HEADER는 "전체선택일 때만" ✔ 표시
    ================================ */

    /* 공통 체크박스 프레임 */
    .tabulator input[type="checkbox"]{
      appearance:none;
      -webkit-appearance:none;
      width:18px;
      height:18px;
      border:2px solid var(--chkBorder);
      border-radius:4px;
      background:#fff;
      cursor:pointer;
      position:relative;
      box-sizing:border-box;
      flex:0 0 auto;
    }

    /* ROW 체크 표시 */
    .tabulator .tabulator-row input[type="checkbox"]:checked::after{
      content:"";
      position:absolute;
      left:5px;
      top:1px;
      width:5px;
      height:10px;
      border-right:3px solid var(--accent);
      border-bottom:3px solid var(--accent);
      transform:rotate(45deg);
    }

    /* HEADER: 부분선택(indeterminate)일 때 아이콘 금지 */
    .tabulator .tabulator-header input[type="checkbox"]:indeterminate::after{
      display:none;
    }

    /* HEADER: 체크 안 됐으면 아이콘 없음 */
    .tabulator .tabulator-header input[type="checkbox"]:not(:checked)::after{
      display:none;
    }

    /* HEADER: 전체선택(checked)일 때만 ✔ 표시 */
    .tabulator .tabulator-header input[type="checkbox"]:checked::after{
      content:"";
      position:absolute;
      left:5px;
      top:1px;
      width:5px;
      height:10px;
      border-right:3px solid var(--accent);
      border-bottom:3px solid var(--accent);
      transform:rotate(45deg);
    }
  </style>
</head>

<body>
  <div class="grid-wrap">
    <div id="doc-grid"></div>
  </div>

  <script>
    const tableData = [
      { id: 1, no: 1, title: "출금이체신청서", type: "바코드" },
      { id: 2, no: 2, title: "보험계약 청약서_202507", type: "바코드" },
      { id: 3, no: 3, title: "보험계약 청약서_202507", type: "바코드" },
      { id: 4, no: 4, title: "개인인CRS대상확인서", type: "바코드" },
      { id: 5, no: 5, title: "자필서명", type: "바코드" },
    ];

    const table = new Tabulator("#doc-grid", {
      data: tableData,
      index: "id",
      layout: "fitColumns",
      height: 320,

      selectable: true,
      selectableRangeMode: "click",

      columns: [
        {
          formatter: "rowSelection",
          titleFormatter: "rowSelection",
          hozAlign: "center",
          headerSort: false,
          width: 52,
        },
        {
          title: "No",
          field: "no",
          width: 60,
          hozAlign: "center",
          headerSort: false,
        },
        {
          title: "문서명",
          field: "title",
          widthGrow: 1,
          headerSort: false,
        },
        {
          title: "구분",
          field: "type",
          width: 140,
          hozAlign: "center",
          headerSort: false,
        },
      ],
    });

    // (테스트용) 선택 데이터 확인
    // console.log(table.getSelectedData());
  </script>
</body>
</html>
